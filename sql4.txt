Display product information which are ordered in the same year of its manufacturing
year.

Ans- select p.* ,extract(year from s.OrderDate) as order_year ,
 extract(year from p.Manufacture_Date) as man_year
 from products p inner join Sales s on s.OrderID=p.OrderID
 where extract(year from s.OrderDate)=extract(year from p.Manufacture_Date)
 
 2. Display product information which are ordered in the same year of its manufacturing year
 where venderis „smith‟.
Ans- select p.* ,extract(year from s.OrderDate) as order_year ,
 extract(year from p.Manufacture_Date) as man_year
 from products p inner join Sales s on s.OrderID=p.OrderID
 inner join Vender_info v on v.Vender_id=p.Vender_id
 where extract(year from s.OrderDate)=extract(year from p.Manufacture_Date)
 and v.Vender_name ='Smith'
 
 3. Display total no. of orders placed in each year.
Ans- select sum(OrderQuantity) as sum ,extract(year from OrderDate) as year
 from sales group by extract(year from OrderDate)
Output-

4. Display total no. of orders placed in each year by vender Wills.
Ans- select sum(s.OrderQuantity) as Total_order,
 extract(year from s.OrderDate)as Order_date from sales s
 inner join products p on p.OrderId=s.OrderId
 inner join Vender_info v on v.Vender_id=p.Vender_id
 where v.Vender_name= 'Wills'
 group by extract(year from s.OrderDate)

Output-

5. Display the name of all those persons who are venders and customers both.

Ans- select distinct(CustomerName) from Sales
 where CustomerName in (select vender_name from Vender_info)
Output-

6. Display total no. of food items ordered every year.
Ans- select sum(s.orderquantity) as total_order,
 extract(year from s.ORDERDATE) as order_year from sales s
 inner join products p on s.OrderID=p.OrderID
 where PRODUCT_ID like 'FD%'
 group by extract(year from s.ORDERDATE)
Output-

7. Display total no. of food items ordered every year made from Bread.
Ans- select sum(s.orderquantity) as total_order,
 extract(year from s.ORDERDATE) as order_year from sales s
 inner join products p on s.OrderID=p.OrderID
 where PRODUCT_ID like 'FD%' and p.Raw_Material='Bread'
 group by extract(year from s.ORDERDATE)

 Output-

8. Display list of product_id whose vender and customer is different.
Ans- select p.product_id,v.vender_name,s.customername from products p
 inner join vender_info v on p.vender_id=v.vender_id
 inner join sales s on p.orderid=s.orderid
 where v.VENDER_NAME!=s.CUSTOMERNAME
Output-

9. Display all those customers who are ordering products of milk by smith.
Ans- select p.product_id,v.vender_name,s.customername,p.Raw_Material from products p
inner join vender_info v on p.vender_id=v.vender_id
inner join sales s on p.orderid=s.orderid
where v.VENDER_NAME='Smith'
and p.Raw_Material='Milk'
Output-

10.Display total no. of orders by each vender every year.
Ans- select count(s.OrderID) as total_no_of_orders,v.Vender_name,
 extract(year from s.ORDERDATE) as year from products p
 inner join vender_info v on p.vender_id=v.vender_id
 inner join sales s on p.orderid=s.orderid
 group by extract(year from s.ORDERDATE),v.Vender_name
Output-

11. Display name of those venders whose products are sold more than 2000 Rs. Every year.
Ans- select sum(s.OrderPrice) as price,v.vender_name,
 extract(year from s.ORDERDATE) as year from products p
 inner join vender_info v on p.vender_id=v.vender_id
 inner join sales s on p.orderid=s.orderid
 group by extract(year from s.ORDERDATE),v.Vender_name
 having sum(s.OrderPrice)>2000
Output-
